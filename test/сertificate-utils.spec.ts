/* tslint:disable */
import {CertificateUtils, EncSign} from '../src';

import {expect} from 'chai';

describe('Test Certificate', () => {

    let encSign: EncSign;

    before(async () => {
        encSign = new EncSign();
    });

    it('Certificate to public key test', async () => {

        // const cert = '-----BEGIN CERTIFICATE-----MIIB6TCCAY+gAwIBAgIUHkmY6fRP0ANTvzaBwKCkMZZPUnUwCgYIKoZIzj0EAwIwGzEZMBcGA1UEAxMQZmFicmljLWNhLXNlcnZlcjAeFw0xNzA5MDgwMzQyMDBaFw0xODA5MDgwMzQyMDBaMB4xHDAaBgNVBAMTE015VGVzdFVzZXJXaXRoQXR0cnMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATmB1r3CdWvOOP3opB3DjJnW3CnN8q1ydiRdzmuA6A2rXKzPIltHvYbbSqISZJubsy8gVL6GYgYXNdu69RzzFF5o4GtMIGqMA4GA1UdDwEB/wQEAwICBDAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBTYKLTAvJJK08OMVGwIhjMQpo2DrjAfBgNVHSMEGDAWgBTEs/52DeLePPx1+65VhgTwu3/2ATAiBgNVHREEGzAZghdBbmlscy1NYWNCb29rLVByby5sb2NhbDAmBggqAwQFBgcIAQQaeyJhdHRycyI6eyJhdHRyMSI6InZhbDEifX0wCgYIKoZIzj0EAwIDSAAwRQIhAPuEqWUpsvTTvBqLR5JeQSctJuz3zaqGRqSs2iW+QB3FAiAIP0mGWKcgSGRMMBvaqaLytBYo9v3hRt1r8j8vN0pMcg==-----END CERTIFICATE-----';
        const cert = Buffer.from('0ac9070a6108031a0c089bc9f1de0510fcd8c4c20322036d79632a40313938313831643035383066633966613330303131343730386533353732343463653030353966623730653438613734343334346661663432306563353464623a08120612046d79636312e3060ac6060a0744454641554c5412ba062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434e6a4343416432674177494241674952414d6e66392f646d563952764343567739705a5155665577436759494b6f5a497a6a304541774977675945780a437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d525977464159445651514845773154595734670a526e4a68626d4e7063324e764d526b77467759445651514b45784276636d63784c6d56345957317762475575593239744d517777436759445651514c45774e440a543141784844416142674e5642414d5445324e684c6d39795a7a45755a586868625842735a53356a623230774868634e4d5463784d5445794d544d304d5445780a5768634e4d6a63784d5445774d544d304d544578576a42704d517377435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a760a636d3570595445574d4251474131554542784d4e5532467549455a795957356a61584e6a627a454d4d416f474131554543784d44513039514d523877485159440a5651514445785a775a5756794d433576636d63784c6d56345957317762475575593239744d466b77457759484b6f5a497a6a3043415159494b6f5a497a6a30440a41516344516741455a3853345637314f424a70794d49565a64775964465841636b49747270765372436630485167343057573958536f4f4f4f3736492b556d660a456b6d546c494a5850372f4179525253525533386f493849767475344d364e4e4d45737744675944565230504151482f42415144416765414d417747413155640a457745422f7751434d4141774b7759445652306a42435177496f4167696e4f5249686e5045465a5568586d366557426b6d374b375a633852342f7a374c5734480a6f7373446c437377436759494b6f5a497a6a304541774944527741775241496756696b49555a7a6766754673474c5148574a55564a43553770446145546b617a0a507a46677343694c785541434943677a4a596c57376e765a7850376236746265753374386d72684d5851733935366d44342b426f4b754e490a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a1218f611bc75c973515912d015323edd406528d1c88b8e835012121d0a1b0a190801120612046d7963631a0d0a0b6372656174654f776e6572', 'hex').toString();
        const pubKey = CertificateUtils.getPublicKeyFromCertificate(cert);

        expect(pubKey).to.not.be.null;

        console.log(pubKey.toString('hex'));

        expect(encSign.isValidPublic(pubKey, true)).to.be.true;

        const pubKeyNew = encSign.importPublic(pubKey);
        expect(pubKeyNew).to.be.length(64);
    });
});
